"use strict";function printMessage(n,t){var i=$("#console-output");i.append($("<div />").addClass("output-text-container").append($("<div />").addClass("output-text-head").html(n)).append($("<div />").addClass("output-text").html(t)));$("#console-output-container").scrollTop(i[0].scrollHeight)}var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();$(function(){printMessage("","Welcome to the Linear Algebra program. ");printMessage("","Conventions: ");printMessage("","1. An M x N matrix contains M rows and N columns.");printMessage("","2. All indices are 1-based, meaning they start from 1 and count upwards");printMessage("","");printMessage("",'Enter the dimensions of the matrix (in the form "M N"): ');var i=0,n,t,r,u=!1;$("#console-input").keydown(function(f){var d=f.keyCode?f.keyCode:f.which,v,c,y,e,p,h,a,w,b,k,l,o,s;if(d==13&&!f.shiftKey&&(v=document.getElementById("console-input"),c=v.textContent,c.trim()!="")){if(v.textContent="",printMessage(">> ",c),i==0)e=c.split(" "),t=parseInt(e[0]),r=parseInt(e[1]),n=t==r?new SquareMatrix(r):new Matrix(t,r),printMessage("","Matrix has dimensions "+t+" x "+r+". "),printMessage("","You will now the entries of the matrix, separated by a single space. ");else if(i<=t)for(e=c.split(" "),s=0;s<r;s++)y=parseInt(e[s],10),n.setValue(y,i-1,s);else if(!u)if(e=c.split(" "),e[0]==="H")printMessage("","Here are the commands: "),printMessage("",'"H": Displays the list of commands.'),printMessage("",'"S [i] [j]": Swaps rows [i] and [j].'),printMessage("",'"X [i] [scale]": Multiplies the elements in row [i] by the integer [scale].'),printMessage("",'"A [i] [j]": Adds row [i] to row [j].'),printMessage("",'"D [i]": Divides the row [i] by the greatest common divisor of numbers in the row and makes the first nonzero element in the row positive.'),printMessage("",'"C [i] [j]": Adds one of row [i] and row [j] by a scalar multiple of the other row to simplify it. Prints out the operations used. For now should only run after descaling all rows'),printMessage("",'"REF": Simplifies to REF form and shows work.'),printMessage("",'"RREF": Simplifies to RREF form and shows work.'),printMessage("",'"DET": Prints out the determinant.'),printMessage("",'"MULT": Multiply with a vector. Arguments should be the entries of the vector separated by a single space. '),printMessage("",'"O": Find an orthogonal basis of the rows of the matrix. The matrix itself is not affected. '),printMessage("",'"Q": End the program.');else if(e[0]==="S"){if(e.length<3&&printMessage("","Error: You need at least 2 arguments for this command"),o=parseInt(e[1]),s=parseInt(e[2]),!Numbers.isInRange(o,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}if(!Numbers.isInRange(s,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}h=n.swap(o-1,s-1,!0);printMessage("",h);printMessage("","The resulting matrix is below:");printMessage("",n.toString())}else if(e[0]==="X"){if(e.length<3&&printMessage("","Error: You need at least 2 arguments for this command"),o=parseInt(e[1]),p=parseInt(e[2]),!Numbers.isInRange(o,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}n.scale(o-1,p);printMessage("","The resulting matrix is below:");printMessage("",n.toString())}else if(e[0]==="A"){if(e.length<3&&printMessage("","Error: You need at least 2 arguments for this command"),o=parseInt(e[1]),s=parseInt(e[2]),!Numbers.isInRange(o,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}if(!Numbers.isInRange(s,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}n.addRow(o-1,s-1);printMessage("","The resulting matrix is below:");printMessage("",n.toString())}else if(e[0]==="D"){if(e.length<2&&printMessage("","Error: You need at least 1 argument for this command"),o=parseInt(e[1]),!Numbers.isInRange(o,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}n.descale(o-1);printMessage("","The resulting matrix is below:");printMessage("",n.toString())}else if(e[0]==="C"){if(e.length<3&&printMessage("","Error: You need at least 2 arguments for this command"),o=parseInt(e[1]),s=parseInt(e[2]),!Numbers.isInRange(o,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}if(!Numbers.isInRange(s,1,t)){printMessage("","Error: Row numbers must be between 1 and "+t+" inclusive. ");return}h=n.cancel(o-1,s-1,!0)[1];printMessage("",h);printMessage("","The resulting matrix is below:");printMessage("",n.toString())}else if(e[0]==="REF")h=n.toREF(!0)[1],printMessage("",h),printMessage("","The resulting matrix is below:"),printMessage("",n.toString());else if(e[0]==="RREF")h=n.toRREF(!0),printMessage("",h),printMessage("","The resulting matrix is below:"),printMessage("",n.toString());else if(e[0]==="DET")n instanceof SquareMatrix?printMessage("","Determinant is: "+n.computeDet()):printMessage("","Error: Determinant of non-square matrix is undefined.");else if(e[0]==="MULT"){for(a=new Vector(n.N),o=0;o<n.N;o++)w=e[o+1],b=parseInt(w),a.setValue(b,o);printMessage("",n.toString()+"* <br/>"+a.toString()+"= ");k=Numbers.multiply(n,a);printMessage("",k.toString())}else if(e[0]==="O"){for(l=n.copy(),o=0;o<l.M;o++)for(l.descale(o),s=0;s<o;s++)l.project(o,s);printMessage("",l.toString())}else e[0]==="Q"?u=!0:printMessage("",'Error: "'+c+'" is not a valid command. Press "H" to see the list of valid commands. ');i<t?printMessage("","Enter the entries of row #"+(i+1)+": "):(i==t&&(printMessage("","The matrix you entered is below:"),printMessage("",n.toString())),printMessage("","<br/>"),u||printMessage("",'Enter next command (enter "H" for help): '));f.preventDefault();i++}})});var Numbers=function(){function n(){}return n.abs=function(n){return n>0?n:-n},n.gcd=function(n,t){var i=this.abs(n),r=this.abs(t);return i==r&&i==0?0:i==0?r:r==0?i:i>r?this.gcd(i%r,r):this.gcd(i,r%i)},n.gcdArr=function(n){for(var u,t=this.abs(n[0]),i=0,r=n;i<r.length;i++)u=r[i],t=this.gcd(t,u);return t},n.isInRange=function(n,t,i){return n<=i&&n>=t?!0:!1},n.min=function(n,t){return n<t?n:t},n.max=function(n,t){return n>t?n:t},n.digitNum=function(t){var i=0;for(t<0&&i++,t=n.abs(t);t>=10;)t=t/10,i++;return i++,i},n.multiply=function(n,t){var u,i,f,r;if(t.N!=n.N)throw new Error("Vector is not correct size");for(u=new Vector(n.M),i=0;i<n.M;i++){for(f=0,r=0;r<n.N;r++)f+=n.vals[i][r]*t.vals[r];u.setValue(f,i)}return u},n}(),Fraction=function(){function n(n,t){if(this.N=n,this.D=t,t==0)try{throw new Error("Denominator cannot be 0.");}catch(i){console.log(i)}}return n.prototype.multiply=function(n){this.N*=n},n.prototype.multiplyFraction=function(n){this.N*=n.N;this.D*=n.D},n.prototype.divide=function(n){if(n==0)try{throw new Error("Cannot divide by 0.");}catch(t){console.log(t)}this.D*=n},n.prototype.simplify=function(){var n=Numbers.gcd(this.N,this.D);this.N/=n;this.D/=n;this.D<0&&(this.N*=-1,this.D*=-1)},n.prototype.toString=function(){return this.simplify(),this.D==1?this.N+"":this.N+"/"+this.D},n}(),Matrix=function(){function n(n,t){var i;for(this.M=n,this.N=t,this.vals=new Array(n),i=0;i<n;i++)this.vals[i]=new Array(t);for(this.pivots=new Array(n),i=0;i<n;i++)this.pivots[i]=t}return n.prototype.setValue=function(n,t,i){var u,r;for(this.vals[t][i]=n,u=!1,r=0;r<this.N;r++)this.vals[t][r]==0||u||(u=!0,this.pivots[t]=r);u||(this.pivots[t]=this.N)},n.prototype.toString=function(){for(var t,u,i="",r=[],n=0;n<this.N;n++)for(r.push(0),t=0;t<this.M;t++)r[n]<Numbers.digitNum(this.vals[t][n])&&(r[n]=Numbers.digitNum(this.vals[t][n]));for(t=0;t<this.M;t++){for(n=0;n<this.N;n++)for(i+=this.vals[t][n],u=Numbers.digitNum(this.vals[t][n]);u<=Numbers.max(r[n],2);u++)i+="&nbsp;";i+="<br/>"}return i},n.prototype.swap=function(n,t,i){for(var u,r=0;r<this.N;r++)u=this.vals[n][r],this.vals[n][r]=this.vals[t][r],this.vals[t][r]=u;return u=this.pivots[n],this.pivots[n]=this.pivots[t],this.pivots[t]=u,i?"R_"+(n+1)+" <-> R_"+(t+1):""},n.prototype.scale=function(n,t){for(var i=0;i<this.N;i++)this.vals[n][i]*=t;return t==0&&(this.pivots[n]=this.N),t},n.prototype.addRow=function(n,t){for(var r,i=0;i<this.N;i++)this.vals[t][i]+=this.vals[n][i];for(r=!1,i=0;i<this.N;i++)this.vals[t][i]=this.vals[t][i],this.vals[t][i]==0||r||(r=!0,this.pivots[t]=i);r||(this.pivots[t]=this.N)},n.prototype.descale=function(n){var i=Numbers.gcdArr(this.vals[n]),r=i,t;if(i!=0){for(t=0;t<this.N;t++)this.vals[n][t]/=i;if(this.vals[n][this.pivots[n]]<0)for(r*=-1,t=0;t<this.N;t++)this.vals[n][t]*=-1}else r=1;return r},n.prototype.cancel=function(n,t,i){var r,u,e="",f=new Fraction(1,1),h,a,c,v,o,s,l,y,p;return this.pivots[n]>this.pivots[t]||this.pivots[n]==this.pivots[t]&&n<t?(r=n,u=t):(r=t,u=n),h=this.descale(r),h!=1&&(a=new Fraction(1,h),f.multiply(h),i&&(e+="R_"+(r+1)+" -> ("+a+") * R_"+(r+1)+"<br/>",e+=this.toString()+"<br/>")),c=this.descale(u),c!=1&&(v=new Fraction(1,c),f.multiply(c),i&&(e+="R_"+(u+1)+" -> ("+v+") * R_"+(u+1)+"<br/>",e+=this.toString()+"<br/>")),o=1,s=1,o*=this.vals[u][this.pivots[r]],s*=-this.vals[r][this.pivots[r]],this.scale(r,o),this.scale(u,s),f.divide(o),f.divide(s),this.addRow(r,u),f.multiply(this.descale(r)),l=this.descale(u),f.multiply(l),y=new Fraction(o,l),p=new Fraction(s,l),i&&(e+="R_"+(u+1)+" -> ("+p+") * R_"+(u+1)+" + ("+y+") * R_"+(r+1)),f.simplify(),[f,e]},n.prototype.toREF=function(n){for(var f,o,s,t,h,r="",u=new Fraction(1,1),e=[],i=0;i<this.M;i++){for(f=Number.MAX_VALUE,o=-1,e=[],s=0,t=i;t<this.M;t++)this.pivots[t]<f?(f=this.pivots[t],e=[],s=0,o=t):this.pivots[t]==f&&(e.push(t),s++);if(f<this.N)for(o!=i&&(this.swap(i,o,n),u.multiply(-1),n&&(r+="<br/>",r+=this.toString()+"<br/>")),t=0;t<s;t++)h=this.cancel(i,e[t],n),u.multiplyFraction(h[0]),n&&(r+=h[1],r+="<br/>",r+=this.toString()+"<br/>"),u.simplify()}for(i=0;i<Numbers.min(this.M,this.N);i++)u.multiply(this.vals[i][i]);return u.simplify(),[u,r]},n.prototype.toRREF=function(n){var i="",t,r,u;for(n&&(i+=this.toREF(n)[1]),t=this.M-1;t>=0;t--)if(this.pivots[t]<this.N)for(r=0;r<t;r++)this.vals[r][this.pivots[t]]!=0&&(u=this.cancel(t,r,n)[1],n&&(i+=u,i+="<br/>",i+=this.toString()+"<br/>"));return i},n.prototype.project=function(n,t){var r=this.getRow(n),i=this.getRow(t),u=Vector.add(Vector.mult(r,Vector.dot(i,i)),Vector.mult(i,-Vector.dot(r,i)));this.setRow(u,n);this.descale(n)},n.prototype.setRow=function(n,t){for(var i=0;i<this.N;i++)this.setValue(n.vals[i],t,i)},n.prototype.getRow=function(n){for(var i=new Vector(this.N),t=0;t<this.N;t++)i.setValue(this.vals[n][t],t);return i},n.prototype.copy=function(){for(var t,r=new n(this.M,this.N),i=0;i<this.M;i++)for(t=0;t<this.N;t++)r.setValue(this.vals[i][t],i,t);return r},n}(),SquareMatrix=function(n){function t(t){return n.call(this,t,t)||this}return __extends(t,n),t.prototype.computeDet=function(){var n=this.copy();return n.toREF(!1)[0]},t}(Matrix),Vector=function(){function n(n){this.N=n;this.vals=new Array(n)}return n.prototype.setValue=function(n,t){this.vals[t]=n},n.prototype.toString=function(){for(var t="",n=0;n<this.N;n++)t+=this.vals[n]+"<br/>";return t},n.dot=function(n,t){for(var r=0,i=0;i<n.N;i++)r+=n.vals[i]*t.vals[i];return r},n.add=function(t,i){for(var u=new n(t.N),r=0;r<t.N;r++)u.setValue(t.vals[r]+i.vals[r],r);return u},n.mult=function(t,i){for(var u=new n(t.N),r=0;r<t.N;r++)u.setValue(t.vals[r]*i,r);return u},n}();